#!/bin/sh

getId=$(pulsemixer --list-sinks | awk '/librespot/ {print $4}' |  sed -e 's/[a-zA-Z]//g' -e 's/[<>,-]//g')

lazy="pulsemixer --id $getId"
getMute=$($lazy --get-mute)
lazyNot="dunstify -h string:x-dunst-stack-tag:spotifydVol"
getVol(){ $lazy --get-volume | awk '{print $1}'; }

notify(){
	case "$1" in
		-c) $lazyNot "Volume: $(getVol)" -h int:value:$(getVol) ;;
		-m) $lazyNot "$( [ $getMute -eq 0 ] && echo "Spotifyd Muted" || echo "Spotifyd Unmuted")" ;;
	esac
}

changeVol(){ 
	if [ $getMute -eq 0 ];then
		$lazy --change-volume $1 && notify -c
	else
		$lazyNot "Spotifyd is muted" "unmute to change volume"
	fi
}

toggleMute(){ $lazy --toggle-mute; }

case "$1" in
	-u) changeVol +2 ;;
	-d) changeVol -2 ;;
	-m) toggleMute && notify -m;;
esac
