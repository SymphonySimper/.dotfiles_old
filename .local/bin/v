#!/bin/sh

#Apps
iv="$IMAGEVIEWER"
vv="$VIDEOPLAYER"
vf="ffplay"
pv="$READER"
te="$EDITOR"
h="devour"
dis="fzf"

#Paths
what_img="$HOME/dl/What"*

main() {
	case "$1" in
		*.jp*g | *.png | *.webp ) $h $iv "$1" ;;
		*.mkv | *.mp4 | *.webm | *.gif | *.avi | *youtu* | *.mp3 ) $h prime-run $vv "$1" ;;
		*.pdf ) $h $pv "$1" ;;
		-a) ls | grep  'jpeg\|jpg\|png\|webp' | $h $iv -t - ;;
		-w) $h $iv $what_img ;;
		-f) $h $vf /dev/video0 ;;
		-d) shift; case "$1" in
				*.pdf ) $h $pv "$1" && rm -i "$1" ;;
				*) $h $iv $what_img && rm -I $what_img ;;
			esac ;;
		-s) shift; $PERM $te "$1" ;;
		-p) ls *.pdf | $dis | xargs -rI {} $h $pv {} ;;
		*) [ -n "$@" ] && $te "$1" ;;
	esac
}

if [ -n "$1" ]; then
	case "$1" in
		-x) shift; main "$1/$(ls -aF "$1" | grep -v / | sed 's|[@*]||g' | $dis)" ;;
		*)main "$@"
	esac
else
	main "$(ls -aF | grep -v / | sed 's|[@*]||g' | $dis)"
fi
