#!/bin/sh

#Apps
IV="$IMAGEVIEWER"
VV="$VIDEOPLAYER"
VF="ffplay"
PV="$READER"
TE="$EDITOR"
H="devour"
DIS="fzf"

#Paths
WHAT_IMG="$HOME/dl/What"*

main() {
	case "$1" in
		*.jp*g | *.png | *.webp ) $H $IV "$1" ;;
		*.mkv | *.mp4 | *.webm | *.gif | *.avi | *youtu* | *.mp3 ) $H prime-run $VV "$1" ;;
		*.pdf ) $H $PV "$1" ;;
		-a) ls | grep  'jpeg\|jpg\|png\|webp' | $H $IV -t - ;;
		-w) $H $IV $WHAT_IMG ;;
		-f) $H $VF /dev/video0 ;;
		-d) shift; case "$1" in
				*.pdf ) $H $PV "$1" && rm -i "$1" ;;
				*) $H $IV $WHAT_IMG && rm -I $WHAT_IMG ;;
			esac ;;
		-s) shift; $PERM $TE "$1" ;;
		-p) ls *.pdf | $DIS | xargs -rI {} $H $PV {} ;;
		*) [ -n "$@" ] && $TE "$1" ;;
	esac
}

if [ -n "$1" ]; then
	main "$@"
else
	main "$(ls -aF | grep -v / | sed 's|[@*]||g' | $DIS)"
fi
