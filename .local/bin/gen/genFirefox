#!/bin/sh
red=$(syl r); bold=$(syl B); reset=$(syl R); green=$(syl g)
error(){ printf "${bold}${red}${1}${reset}\n"; }
success(){ printf "${bold}${green}${1}${reset}\n"; }

loc="$HOME"/.mozilla/firefox
profile0loc="$loc"/$(grep Default "$loc"/profiles.ini | cut -d '=' -f 2 | head -n 1)

configLoc="$HOME"/.config/firefox
chrome="$configLoc"/chrome
userPref="$configLoc"/user.js

forceLink(){ ln -sf "$1" "$profile0loc" && success "$1 folder linked" || error "$1 folder not linked"; }
linkChrome(){ forceLink "$chrome"; }
linkUserPref(){ forceLink "$userPref"; }
while :; do
	if [ -e "$profile0loc"/chrome ]; then
		error "Chrome folder already exists at\n$profile0loc"
		read -r -p "Would you like to override it? [y/N]" ans
		case "$ans" in
			[yY]* ) linkChrome ;;
			[nN]* | * ) 
					read -r -p "Would you like to continue to user pref? [Y/n]" ans
					case "$ans" in
						[nN]* ) error "Aborting"; exit;;
						[yY]* | * ) success "Initiating user pref link" ;;
					esac ;;
		esac
	else
		linkChrome
	fi
	if [ -f "$profile0loc"/user.js ]; then
		error "user.js file already exists at\n$profile0loc"
		read -r -p "Would you like to override it? [y/N]" ans
		case "$ans" in
			[yY]* ) linkUserPref ;break ;;
			[nN]* | * ) error "Aborting"; exit;;
		esac
	else
		linkUserPref
		break
	fi
	echo bruh
done
