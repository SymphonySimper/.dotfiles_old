#!/bin/sh

red=`syl r`; green=`syl g`; bold=`syl B`; reset=`syl R`
error(){ echo "$bold$red$1$reset"; }
success(){ echo "$bold$green$1$reset"; }

perm="doas"

#Path
ntfs="$HOME/ntfs"; usb="$HOME/usb"
ntfsMount(){ "$perm" ntfs-3g /dev/$1 $ntfs && success "Ntfs mounted"; }
mountUsb(){ "$perm" mount -o umask=0,uid=nobody,gid=nobody /dev/$1 $usb && success "Usb mounted"; }
umountDev(){ "$perm" umount $1; }

#Gets the mounted point
whatd=$(lsblk -lp | awk '/usb/ || /ntfs/ {print $1}')
umountAll(){
	if lsblk | grep -q 'ntfs'; then
		umountDev $whatd && success "Ntfs umounted"
	elif lsblk | grep -q 'usb'; then
		umountDev $whatd && success "Usb umounted"
	else error "No drives found"; exit 1; fi
}

case "$1" in
	-u) shift; mountUsb $1 ;;
	-n) shift; ntfsMount $1 ;;
	-o) shift; umountAll ;;
	*) error "Invalid option"; echo "-u for usb\n-n for ntfs\n-o for umount"; exit 1 ;;
esac
