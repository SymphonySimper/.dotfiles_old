#!/bin/sh

NOTIFY="dunstify"
TODOLOC="$XDG_DATA_HOME"/.todo

#Icons
DIR="$HOME"/.local/share/icons/myInfo
BATFULLI="$DIR"/batteryFull.svg
LOWBATI="$DIR"/lowBattery.svg
CHARGINGI="$DIR"/charging.svg
SAVERI="$DIR"/saver.svg
DATEI="$DIR"/date.svg
CLOCKI="$DIR"/clock.svg

getStat=$(cat /sys/class/power_supply/BAT0/status)
getCap=$(cat /sys/class/power_supply/BAT0/capacity)
notifyBat(){ $NOTIFY -h string:x-dunst-stack-tag:myBattery -i "$1"  "Battery level: $getCap%"; }
bat(){
	if [ $getStat = 'Unknown' ]; then
		notifyBat "$SAVERI"
	elif [ $getStat = 'Charging' ]; then
		notifyBat "$CHARGINGI"
	elif [ $getStat = 'Discharging' ]; then
		[ $getCap -gt 20 ] && notifyBat "$BATFULLI" || notifyBat "$LOWBATI"
	fi
}

DATEP="date"
getDateTxt=$($DATEP "+%A %B %Y")
getDate=$($DATEP "+%d/%m/%Y")
getTime=$($DATEP "+%r")
notifyDate(){ $NOTIFY -h string:x-dunst-stack-tag:myDate -i "$DATEI" "$getDate" "$getDateTxt"; }

notifyTime(){ $NOTIFY -h string:x-dunst-stack-tag:myTime -i "$CLOCKI"  "$getTime"; }
listTodo(){
	cat $TODOLOC | while read -r LINE; do
		$NOTIFY "+" "$LINE"
	done
}

bat; notifyDate; notifyTime; listTodo
