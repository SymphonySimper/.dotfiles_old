#!/bin/sh

notify="dunstify"
pathBat="$HOME/.local/share/icons/battery"
pathDate="$HOME/.local/share/icons/date"
todo="$HOME/.todo"
lowI="$pathBat/low.svg"
fullI="$pathBat/full.svg"
chargingI="$pathBat/charging.svg"
saverI="$pathBat/saver.svg"
dateI="$pathDate/date.svg"
clockI="$pathDate/clock.svg"


getStat=$(cat /sys/class/power_supply/BAT0/status)
getCap(){ cat /sys/class/power_supply/BAT0/capacity; }

notifyBat(){ $notify -h string:x-dunst-stack-tag:myBattery -i $1 "Battery level: $(getCap)%"; }

showBat(){
	if [ $getStat = Unknown ];then
		notifyBat $saverI
	elif [ $getStat = Charging ];then
		notifyBat $chargingI
	elif [ $getStat = Discharging ];then
		[ $(getCap) > 20 ] && notifyBat $fullI || notifyBat $lowI
	fi
}

getDateTxt=$(date "+%A %B %Y")
getDate=$(date "+%D")
getTime=$(date "+%r")
notifyDate(){ $notify -h string:x-dunst-stack-tag:myDate -i $dateI "$getDate" "$getDateTxt"; }
notifyTime(){ $notify -h string:x-dunst-stack-tag:myTime -i $clockI "$getTime"; }
todo(){ cat $todo | while read -r line ; do $notify "+" "$line"; done; }
showBat; notifyDate; notifyTime; todo
